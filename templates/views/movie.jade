extends ../layouts/default
include ../mixins/movie

block content
	if !movie
		.jumbotron.text-center
			h2 電影不存在!
			p.lead 請檢查網址並再次嘗試...
	else
		.row
			.col-md-8.col-md-offset-2
				p: a(href='/movie_blog').text-muted &larr; back to the blog
				hr
				article
					header
						h1= movie.name
						if movie.image.exists
							div(style="margin-bottom: 20px; margin-top: 20px;")
								img(src=movie._.image.fit(750,500)).img-responsive
						div
							p.text-muted.text-small Posted 
								if movie.publishedDate
									| on 
									time(datetime=movie.publishedDate)=movie._.publishedDate.format('MMMM Do, YYYY')
								if movie.categories && movie.categories.length
									|  in 
									each cat, cat_i in movie.categories
										a(href='/movie_blog/' + cat.key)= cat.name
										if cat_i < movie.categories.length - 1
											| , 
										else
											|  
								if movie.author
									| by #{movie.author.name.full}
						hr
						!= movie.content.full
					//-comments
					//- div
					//- 	+comment-form()
					//- 	+comment-thread(comments)


block page-js
	script.
		jQuery(function($) {
			
			var comments = $('#comments');
			var input = $('.comment-field-input');
			var submit = comments.find('button[type=submit]');

			
			// Scroll to comments and focus input field
			function scrollToComments(e) {
				
				e.preventDefault();
				
				$('html, body').animate({ scrollTop: comments.offset().top }, 250);
				
				input.eq(0).focus();
			}
			$('[href="#comments"]').click( scrollToComments );
			
			
			
			// Check if field has content: enable/disable submit. Disable by default
			submit.attr('disabled','disabled');
			input.keyup(function() {
				if ($.trim($(this).val())) {
					submit.removeAttr('disabled');
				} else {
					submit.attr('disabled','disabled');
				}
			});
		});
