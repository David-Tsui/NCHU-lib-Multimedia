extends ../layouts/default

include ../mixins/post
block content
	.ui.grid.main-container
		.ui.thirteen.wide.column
			aside
				a(href="/") 
					button.mdl-button.mdl-js-button.mdl-button--raised.mdl-js-ripple-effect.mdl-color--primary= '回首頁'
				if user
					a(href='/keystone/posts?new')
						button.mdl-button.mdl-js-button.mdl-button--raised.mdl-js-ripple-effect.mdl-color--primary= '新文章'
			header
				h2=category ? category.name : '文章總覽'
			main
				if filters.category && !category
					//- h3 No such category!
					h3 分類不存在!
				else
					if posts.results.length
						if posts.totalPages > 1
							.lead.text-muted Showing 
								strong #{posts.first}
								|  to 
								strong #{posts.last}
								|  of 
								strong #{posts.total}
								|  posts
						else
							//- .lead.text-muted Showing #{utils.plural(posts.results.length, '* post')}
							h4 共有 #{posts.results.length} 篇文章
						.ui.grid
							.ui.link.items
								each post in posts.results
									+post(post)
						if posts.totalPages > 1
							ul.pagination
								if posts.previous
									li: a(href='?page=' + posts.previous): span.glyphicon.glyphicon-chevron-left
								else
									li.disabled: a(href='?page=' + 1): span.glyphicon.glyphicon-chevron-left
								each p, i in posts.pages
									li(class=posts.currentPage === p ? 'active' : null)
										a(href='?page=' + (p === '...' ? (i ? posts.totalPages : 1) : p ))= p
								if posts.next
									li: a(href='?page=' + posts.next): span.glyphicon.glyphicon-chevron-right
								else
									li.disabled: a(href='?page=' + posts.totalPages): span.glyphicon.glyphicon-chevron-right
					else
						if category
							.jumbotron.text-center
								h3(style="margin-bottom:0;margin-top:0;") No posts in the category #{category.name}.
						else
							.jumbotron.text-center
								h3(style="margin-bottom:0;margin-top:0;") There are no posts yet.
		.ui.three.wide.column
			if categories.length
				h4 電影分類
				ul.mdl-list
					li.mdl-list__item
						a(href='/blog') 全部
					each cat in categories
						li.mdl-list__item
							a(href='/blog/' + cat.key)
								span.mdl-badge(data-badge=cat.postCount)= cat.name
