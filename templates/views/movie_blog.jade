extends ../layouts/default

include ../mixins/movie
block content
	.ui.grid.main-container
		.ui.fourteen.wide.column
			aside
				a(href="/") 
					button.mdl-button.mdl-js-button.mdl-button--raised.mdl-js-ripple-effect.mdl-color--primary= '回首頁'
				if user
					a(href='/keystone/movies?new') 
						button.mdl-button.mdl-js-button.mdl-button--raised.mdl-js-ripple-effect.mdl-color--primary= '新電影'
			h2=category ? category.name : '影片總覽'
				//- a(href='/keystone/movies?new').btn.btn-default.pull-right= user ? 'Write Post' : 'Sign in to Write Post'
				//- h1=category ? category.name : 'Movie_blog'
			if filters.category && !category
				//- h3 No such category!
				h3 分類不存在!
			else
				if movies.results.length
					if movies.totalPages > 1
						.lead.text-muted Showing 
							strong #{movies.first}
							|  to 
							strong #{movies.last}
							|  of 
							strong #{movies.total}
							|  movies
					else
						//- .lead.text-muted Showing #{utils.plural(movies.results.length, '* movie')}
						h4 共有 #{movies.results.length} 部電影
					.ui.grid
						.ui.four.column.row
							each movie in movies.results
								.column
									+movie(movie)
					if movies.totalPages > 1
						ul.pagination
							if movies.previous
								li: a(href='?page=' + movies.previous): span.glyphicon.glyphicon-chevron-left
							else
								li.disabled: a(href='?page=' + 1): span.glyphicon.glyphicon-chevron-left
							each p, i in movies.pages
								li(class=movies.currentPage === p ? 'active' : null)
									a(href='?page=' + (p === '...' ? (i ? movies.totalPages : 1) : p ))= p
							if movies.next
								li: a(href='?page=' + movies.next): span.glyphicon.glyphicon-chevron-right
							else
								li.disabled: a(href='?page=' + movies.totalPages): span.glyphicon.glyphicon-chevron-right
				else
					if category
						.jumbotron.text-center
							h3(style="margin-bottom:0;margin-top:0;") No movies in the category #{category.name}.
					else
						.jumbotron.text-center
							h3(style="margin-bottom:0;margin-top:0;") There are no movies yet.
		.ui.two.wide.column
			if categories.length
				//- .lead.text-muted Category
				.lead.text-muted 電影分類
				ul.nav.nav-pills.nav-stacked
					li(class=!category ? 'active' : null)
						//- a(href='/blog') All
						a(href='/movie_blog') 全部
					each cat in categories
						li(role="presentation" class=category && category.id === cat.id ? 'active' : null)
							a(href='/movie_blog/' + cat.key)
								=cat.name
								if cat.movieCount
									span.badge.pull-right= cat.movieCount
